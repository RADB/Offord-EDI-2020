@using Syncfusion.Blazor.RichTextEditor
@inject ISharedService sharedService
@inject NavigationManager NavigationManager

<SfRichTextEditor @ref="RteObj" @bind-Value="@BindValue" Placeholder="Put content here..."  UndoRedoSteps="50" UndoRedoTimer="400">
    <RichTextEditorImageSettings SaveUrl="api/Image" Path=@Path></RichTextEditorImageSettings>
    <RichTextEditorEvents OnImageUploadSuccess="@onSuccess"> </RichTextEditorEvents>
    <RichTextEditorToolbarSettings Type="ToolbarType.Expand" Items="@tools"></RichTextEditorToolbarSettings>
</SfRichTextEditor>

@code {
    // i couldnt get this to work - it wouldnt bind to the object
    [Parameter]
    public string BindValue { get; set; }

    public string Path { get; set; }

    SfRichTextEditor RteObj;

    public string[] header { get; set; }

    public static object[] tools = new object[]{
        "Bold", "Italic", "Underline", "StrikeThrough",
        "FontName", "FontSize", "FontColor", "BackgroundColor",
        "LowerCase", "UpperCase", "|",
        "Formats", "Alignments", "OrderedList", "UnorderedList",
        "Outdent", "Indent", "|", "CreateTable",
        "CreateLink", "Image", "|", "ClearFormat",
        "SourceCode", "|", "Undo", "Redo"
    };

    private void onSuccess(ImageSuccessEventArgs args)
    {
        var headers = args.Response.Headers.ToString();
        header = headers.Split("name: ");
        header = header[1].Split("\r");
        args.File.Name = header[0];
    }

    protected override async Task OnInitializedAsync()
    {
        Path = NavigationManager.BaseUri + sharedService.GetImagePath() + "/";
    }
}
